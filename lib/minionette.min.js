// Backbone.Minionette
// -------------------
// v0.2.4
//
// Copyright (c)2013 Justin Ridgewell
// Distributed under MIT license
//
// https://github.com/jridgewell/minionette

var Minionette=function(e,t,i,r){"use strict";var n={};if(r.Minionette=n,i){var s=i.cleanData;i.cleanData=function(e){t.each(e,function(e){try{i(e).triggerHandler("remove")}catch(t){}}),s(e)}}return n.View=r.View.extend({constructor:function(){r.View.apply(this,arguments),this._subViews={},this._listenToEvents(this.model,this.modelEvents),this._listenToEvents(this.collection,this.collectionEvents)},_parentView:null,template:function(){return""},serializeData:function(){return{}},delegateEvents:function(){r.View.prototype.delegateEvents.apply(this,arguments),t.bindAll(this,"_jqueryRemove"),this.$el.on("remove.delegateEvents"+this.cid,this._jqueryRemove)},remove:function(){this.trigger("remove:before"),this._removeFromParentView(),this._removeSubViews(),r.View.prototype.remove.apply(this,arguments),this.trigger("remove")},render:function(){return this.trigger("render:before"),t.each(this._subViews,function(e){e.$el.detach()}),this.$el.html(this.template(this.serializeData())),this.trigger("render"),this},assign:function(e,i,r){var n;t.isObject(e)?(n=e,r=i):(n={},n[e]=i),n&&t.each(n,function(e,t){this._subViews[e.cid]=e,e._parentView=this,r?this.$(t).replaceWith(e.el):e.setElement(this.$(t)).render()},this)},_removeFromParentView:function(){this._parentView&&this._parentView._removeSubView(this)},_removeSubView:function(e){delete this._subViews[e.cid]},_removeSubViews:function(){t.invoke(this._subViews,"remove")},_jqueryRemove:function(){this.trigger("remove:jquery"),this._removeFromParentView(),this.stopListening()},_listenToEvents:function(e,i){if(e){for(var r in i){var n=i[r];t.isFunction(n)||(n=this[n]),n&&this.listenTo(e,r,n)}return this}}}),n.ModelView=n.View.extend({modelEvents:{change:"render",destroy:"remove"},serializeData:function(){return t.clone(this.model.attributes)}}),n.CollectionView=n.View.extend({ModelView:r.View,collectionEvents:{add:"addOne",remove:"removeOne",reset:"render",sort:"render"},render:function(){this.trigger("render:before");var e=this.$el.html(this.template(this.serializeData()));this.$el=i(document.createDocumentFragment());var t=this._getModelView();return this.collection.each(function(e){this._addModelView(e,t)},this),this.$el=e.append(this.$el),this.trigger("render"),this},addOne:function(e){this.trigger("addOne:before");var t=this._getModelView(),i=this._addModelView(e,t);return this.trigger("addOne"),i},removeOne:function(e){this.trigger("removeOne:before");var t=this._findSubViewByModel(e);return t&&t.remove(),this.trigger("removeOne"),t},_addModelView:function(e,t){var i=new t({model:e});return this._subViews[i.cid]=i,i._parentView=this,this.$el.append(i.render().el),i},_getModelView:function(){var e=this.ModelView;return this.options&&this.options.ModelView&&(e=this.options.ModelView),e},_findSubViewByModel:function(e){return t.findWhere(this._subViews,{model:e})}}),n}(this,_,jQuery,Backbone);
//@ sourceMappingURL=lib/minionette.map